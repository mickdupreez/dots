"use strict";µBlock.urlTokenizer={setURL:function(a){return a!==this._urlIn&&(this._urlIn=a,this._urlOut=a.toLowerCase(),this._tokenized=!1),this._urlOut},getTokens:function(){return this._tokenized===!1&&(void 0===this._gcAfter&&(this._gcAfter=Date.now()+1499),this._tokenize(),this._tokenized=!0),this._tokens},isTokenized:function(){return null!==this._tokens&&""!==this._tokens[0].token},_Entry:function(){this.beg=0,this.token=void 0},_init:function(){this._tokens=new Array(2048);for(var a=0;2048>a;a++)this._tokens[a]=new this._Entry;this._init=null},_tokenize:function(){var a,b,c=this._tokens,d=this._reAnyToken,e=this._urlOut;d.lastIndex=0;for(var f=0;2047>f&&(a=d.exec(e),null!==a);f++)b=c[f],b.beg=a.index,b.token=a[0];if(c[f].token="",!(Date.now()<this._gcAfter))for(this._gcAfter=void 0,f+=1;2047>f&&(b=c[f],void 0!==b.token);f++)b.token=void 0},_urlIn:"",_urlOut:"",_tokenized:!1,_tokens:null,_reAnyToken:/[%0-9a-z]+/g,_gcAfter:void 0},µBlock.urlTokenizer._init(),µBlock.formatCount=function(a){if("number"!=typeof a)return"";var b=a.toFixed(0);return a>=1e3&&(b=1e4>a?">"+b.slice(0,1)+"k":1e5>a?b.slice(0,2)+"k":1e6>a?b.slice(0,3)+"k":1e7>a?b.slice(0,1)+"M":b.slice(0,-6)+"M"),b},µBlock.dateNowToSensibleString=function(){var a=new Date(Date.now()-6e4*(new Date).getTimezoneOffset());return a.toISOString().replace(/\.\d+Z$/,"").replace(/:/g,".").replace("T","_")},µBlock.LineIterator=function(a,b){this.text=a,this.textLen=this.text.length,this.offset=b||0},µBlock.LineIterator.prototype.next=function(){var a=this.text.indexOf("\n",this.offset);-1===a&&(a=this.text.indexOf("\r",this.offset),-1===a&&(a=this.textLen));var b=this.text.slice(this.offset,a);return this.offset=a+1,b},µBlock.LineIterator.prototype.rewind=function(){if(this.offset<=1)return void(this.offset=0);var a=this.text.lastIndexOf("\n",this.offset-2);-1!==a?this.offset=a+1:(a=this.text.lastIndexOf("\r",this.offset-2),this.offset=-1!==a?a+1:0)},µBlock.LineIterator.prototype.eot=function(){return this.offset>=this.textLen},µBlock.FieldIterator=function(a){this.text="",this.sep=a,this.sepLen=a.length,this.offset=0},µBlock.FieldIterator.prototype.first=function(a){return this.text=a,this.offset=0,this.next()},µBlock.FieldIterator.prototype.next=function(){var a=this.text.indexOf(this.sep,this.offset);-1===a&&(a=this.text.length);var b=this.text.slice(this.offset,a);return this.offset=a+this.sepLen,b},µBlock.mapToArray="function"==typeof Array.from?Array.from:function(a){for(var b,c=[],d=a.entries();b=d.next(),!b.done;)c.push([b.value[0],b.value[1]]);return c},µBlock.mapFromArray=function(a){return new Map(a)},µBlock.setToArray="function"==typeof Array.from?Array.from:function(a){for(var b,c=[],d=a.values();b=d.next(),!b.done;)c.push(b.value);return c},µBlock.setFromArray=function(a){return new Set(a)},µBlock.openNewTab=function(a){a.url.startsWith("logger-ui.html")&&(a.shiftKey&&this.changeUserSettings("alwaysDetachLogger",!this.userSettings.alwaysDetachLogger),a.popup=this.userSettings.alwaysDetachLogger),vAPI.tabs.open(a)},µBlock.matchCurrentLanguage=function(a){return"string"!=typeof a?!1:(void 0===this.matchCurrentLanguage.reLang&&(this.matchCurrentLanguage.reLang=new RegExp("\\b"+self.navigator.language.slice(0,2)+"\\b")),this.matchCurrentLanguage.reLang.test(a))};
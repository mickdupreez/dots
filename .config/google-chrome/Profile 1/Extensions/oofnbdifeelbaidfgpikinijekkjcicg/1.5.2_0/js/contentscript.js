"use strict";if("object"!=typeof vAPI)throw new Error("");vAPI.lock(),vAPI.matchesProp=function(){var a=document.documentElement;if("function"!=typeof a.matches){if("function"==typeof a.mozMatchesSelector)return"mozMatchesSelector";if("function"==typeof a.webkitMatchesSelector)return"webkitMatchesSelector";if("function"==typeof a.msMatchesSelector)return"msMatchesSelector"}return"matches"}(),vAPI.SafeAnimationFrame=function(a){this.fid=this.tid=null,this.callback=a},vAPI.SafeAnimationFrame.prototype.start=function(){null===this.fid&&(this.fid=requestAnimationFrame(this.callback),this.tid=vAPI.setTimeout(this.callback,12e5))},vAPI.SafeAnimationFrame.prototype.clear=function(){null!==this.fid&&(cancelAnimationFrame(this.fid),clearTimeout(this.tid),this.fid=this.tid=null)},vAPI.domFilterer=function(){var a,b=createSet(),c=createSet(),d=[],e=createSet("object"),f=null,g=function(){f=null,vAPI.messaging.send("contentscript",{what:"cosmeticFiltersActivated"})},h=function(){return vAPI.userCSS instanceof Object?vAPI.userCSS:{enabled:!0,styles:[],add:function(a){var b=document.createElement("style");b.setAttribute("type","text/css"),b.textContent=a,document.head&&document.head.appendChild(b),this.styles.push(b),b.sheet&&(b.sheet.disabled=!this.enabled)},remove:function(a){for(var b,c,d=this.styles.length;d--;)b=this.styles[d],b.textContent===a&&(c=b.parentNode,null!==c&&c.removeChild(b),this.styles.splice(d,1))},toggle:function(a){if(""!==this.styles.length){void 0===a&&(a=!this.enabled);for(var b,c=this.styles.length;c--;)b=this.styles[c],null!==b.sheet&&(b.sheet.disabled=!a);this.enabled=a}}}}(),i=vAPI.hideNode,j=vAPI.unhideNode;!function(){if(!(i instanceof Function)){var a,b,c,d=[],e={attributes:!0,attributeFilter:["style"]},f=function(){b.clear();for(var c,e=d,f=e.length,g=[],h=0;f--;)c=e[f],void 0!==c[a]&&c.clientHeight&&c.clientWidth&&(g[h++]=c);for(e.length=0;h--;){c=g[h];var i=c.getAttribute("style");i?i+="; ":i="",c.setAttribute("style",i+"display: none !important;")}},g=function(a){for(var c=a.length,e=d,f=e.length;c--;)e[f++]=a[c].target;b.start()};i=function(h){void 0===a&&(a=vAPI.randomToken(),b=new vAPI.SafeAnimationFrame(f)),void 0===h[a]&&(h[a]=h.hasAttribute("style")&&(h.getAttribute("style")||""));var i=d;i[i.length]=h,b.start(),void 0===c&&(c=new MutationObserver(g)),c.observe(h,e)},j=function(b){if(void 0!==a){var c=b[a];c===!1?b.removeAttribute("style"):"string"==typeof c&&b.setAttribute("style",c),delete b[a]}}}}();var k=function(a){this.selector=a[1]};k.prototype.exec=function(a){for(var b=[],c=0,d=a.length;d>c;c++)null!==a[c].querySelector(this.selector)&&b.push(a[c]);return b};var l=function(a){this.needle=new RegExp(a[1])};l.prototype.exec=function(a){for(var b=[],c=0,d=a.length;d>c;c++)this.needle.test(a[c].textContent)&&b.push(a[c]);return b};var m=function(a){this.pselector=new s(a[1])};m.prototype.target=!0,m.prototype.exec=function(a){for(var b=[],c=0,d=a.length;d>c;c++)this.pselector.test(a[c])===this.target&&b.push(a[c]);return b};var n=function(a){m.call(this,a),this.target=!1};n.prototype=Object.create(m.prototype),n.prototype.constructor=n;var o=function(a){this.name=a[1].name,this.value=new RegExp(a[1].value)};o.prototype.pseudo=null,o.prototype.exec=function(a){for(var b,c=[],d=0,e=a.length;e>d;d++){if(b=window.getComputedStyle(a[d],this.pseudo),null===b)return null;this.value.test(b[this.name])&&c.push(a[d])}return c};var p=function(a){o.call(this,a),this.pseudo=":after"};p.prototype=Object.create(o.prototype),p.prototype.constructor=p;var q=function(a){o.call(this,a),this.pseudo=":before"};q.prototype=Object.create(o.prototype),q.prototype.constructor=q;var r=function(a){this.xpe=document.createExpression(a[1],null),this.xpr=null};r.prototype.exec=function(a){for(var b,c,d=[],e=0,f=a.length;f>e;e++)for(this.xpr=this.xpe.evaluate(a[e],XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,this.xpr),b=this.xpr.snapshotLength;b--;)c=this.xpr.snapshotItem(b),1===c.nodeType&&d.push(c);return d};var s=function(a){void 0===s.prototype.operatorToTaskMap&&(s.prototype.operatorToTaskMap=new Map([[":has",k],[":has-text",l],[":if",m],[":if-not",n],[":matches-css",o],[":matches-css-after",p],[":matches-css-before",q],[":xpath",r]])),this.raw=a.raw,this.selector=a.selector,this.tasks=[];var b=a.tasks;if(b)for(var c,d,e=0;e<b.length;e++)c=b[e],d=this.operatorToTaskMap.get(c[0]),this.tasks.push(new d(c))};s.prototype.operatorToTaskMap=void 0,s.prototype.prime=function(a){var b=a||document;return""!==this.selector?b.querySelectorAll(this.selector):[b]},s.prototype.exec=function(a){for(var b=this.tasks,c=this.prime(a),d=0,e=b.length;e>d&&0!==c.length;d++)c=b[d].exec(c);return c},s.prototype.test=function(a){for(var b,c=this.tasks,d=this.prime(a),e=[null],f=0,g=d.length;g>f;f++){e[0]=d[f],b=e;for(var h=0,i=c.length;i>h&&0!==b.length;h++)b=c[h].exec(b);if(0!==b.length)return!0}return!1};var t={addedNodesHandlerMissCount:0,commitTimer:null,disabledId:vAPI.randomToken(),enabled:!0,excludeId:void 0,hiddenId:vAPI.randomToken(),hiddenNodeCount:0,hiddenNodeEnforcer:!1,loggerEnabled:void 0,newHideSelectorBuffer:[],newStyleRuleBuffer:[],simpleHideSelectors:{entries:[],matchesProp:vAPI.matchesProp,selector:void 0,add:function(a){this.entries.push(a),this.selector=void 0},forEachNode:function(a,b,c){void 0===this.selector&&(this.selector=this.entries.join(c+",")+c),b[this.matchesProp](this.selector)&&a(b);for(var d=b.querySelectorAll(this.selector),e=d.length;e--;)a(d[e])}},complexHideSelectors:{entries:[],selector:void 0,add:function(a){this.entries.push(a),this.selector=void 0},forEachNode:function(a){void 0===this.selector&&(this.selector=this.entries.join(","));for(var b=document.querySelectorAll(this.selector),c=b.length;c--;)a(b[c])}},nqsSelectors:[],proceduralSelectors:{entries:[],add:function(a){this.entries.push(new s(a))},forEachNode:function(a){for(var b,c,d,e=this.entries,f=e.length;f--;)for(b=e[f],c=b.exec(),d=c.length;d--;)a(c[d],b)}},addExceptions:function(a){for(var c=0,d=a.length;d>c;c++)b.add(a[c])},addSelector:function(a){if(!c.has(a)&&!b.has(a)){if(c.add(a),123!==a.charCodeAt(0))return this.newHideSelectorBuffer.push(a),void(-1===a.indexOf(" ")?this.simpleHideSelectors.add(a):this.complexHideSelectors.add(a));var d=JSON.parse(a);return d.style?(this.newStyleRuleBuffer.push(d.style.join(" ")),void this.nqsSelectors.push(d.raw)):d.pseudoclass?(this.newHideSelectorBuffer.push(d.raw),void this.nqsSelectors.push(d.raw)):d.tasks?void this.proceduralSelectors.add(d):void 0}},addSelectors:function(a){for(var b=0,c=a.length;c>b;b++)this.addSelector(a[b])},commit_:function(){this.commitTimer.clear();var b,c=this.hiddenNodeCount,i="";if(this.newHideSelectorBuffer.length&&(i="\n:root "+this.newHideSelectorBuffer.join(",\n:root ")+"\n{ display: none !important; }",this.newHideSelectorBuffer.length=0),this.newStyleRuleBuffer.length&&(i+="\n"+this.newStyleRuleBuffer.join("\n"),this.newStyleRuleBuffer.length=0),this.simpleHideSelectors.entries.length)for(b=d.length;b--;)this.simpleHideSelectors.forEachNode(u,d[b],w);d=[],a=e,e=createSet("object"),this.complexHideSelectors.entries.length&&this.complexHideSelectors.forEachNode(v),this.proceduralSelectors.entries.length&&this.proceduralSelectors.forEachNode(v);var j=this.hiddenNodeCount!==c;if(j?(this.hiddenNodeEnforcer===!1&&(i+="\n:root *["+this.hiddenId+"][hidden] { display: none !important; }",this.hiddenNodeEnforcer=!0),this.addedNodesHandlerMissCount=0):this.addedNodesHandlerMissCount+=1,""!==i&&h.add(i),b=a.size,0!==b){for(var k=a.values();b--;)this.unhideNode(k.next().value);a.clear()}this.loggerEnabled!==!1&&j&&null===f&&(f=vAPI.setTimeout(g,503))},commit:function(a,b){return"all"===a?d=[document.documentElement]:d[0]!==document.documentElement&&(d=d.concat(a)),b?(this.commitTimer.clear(),void this.commit_()):void this.commitTimer.start()},createProceduralFilter:function(a){return new s(a)},getExcludeId:function(){return void 0===this.excludeId&&(this.excludeId=vAPI.randomToken()),this.excludeId},hideNode:function(a){void 0===a[this.hiddenId]&&(void 0!==this.excludeId&&a[this.excludeId]||(a.setAttribute(this.hiddenId,""),this.hiddenNodeCount+=1,a.hidden=!0,a[this.hiddenId]=null,i(a)))},init:function(){this.commitTimer=new vAPI.SafeAnimationFrame(this.commit_.bind(this))},showNode:function(a){a.hidden=!1,j(a)},toggleLogging:function(a){this.loggerEnabled=a},toggleOff:function(){h.toggle(!1),this.enabled=!1},toggleOn:function(){h.toggle(!0),this.enabled=!0},userCSS:h,unhideNode:function(a){void 0!==a[this.hiddenId]&&this.hiddenNodeCount--,a.removeAttribute(this.hiddenId),a[this.hiddenId]=void 0,a.hidden=!1,j(a)},unshowNode:function(a){a.hidden=!0,i(a)},domChangedHandler:function(a){this.commit(a)},start:function(){var a=this.domChangedHandler.bind(this);vAPI.domWatcher.addListener(a),vAPI.shutdown.add(function(){vAPI.domWatcher.removeListener(a)})}},u=t.hideNode.bind(t),v=function(b){e.add(b),a["delete"](b)||u(b)},w=":not(["+t.hiddenId+"])";return t.init(),t}(),function(){var a=function(a){var b=a&&a.specificCosmeticFilters;if(!b||!b.ready)return vAPI.domWatcher=vAPI.domCollapser=vAPI.domFilterer=vAPI.domSurveyor=vAPI.domIsLoaded=null,void vAPI.unlock();if(a.noCosmeticFiltering)vAPI.domFilterer=null,vAPI.domSurveyor=null;else{var c=vAPI.domFilterer;c.toggleLogging(a.loggerEnabled),(a.noGenericCosmeticFiltering||b.noDOMSurveying)&&(vAPI.domSurveyor=null),(0!==b.cosmeticHide.length||0!==b.cosmeticDonthide.length)&&(c.addExceptions(b.cosmeticDonthide),c.addSelectors(b.cosmeticHide),c.commit("all",!0))}var d=document.head||document.documentElement;if(d){var e,f;0!==b.netHide.length&&(e=document.createElement("style"),e.setAttribute("type","text/css"),f=b.netHide.join(",\n"),f+=a.collapseBlocked?"\n{display:none !important;}":"\n{visibility:hidden !important;}",e.appendChild(document.createTextNode(f)),d.appendChild(e)),b.scripts&&(e=document.createElement("script"),f=b.scripts+"\n(function() {\n    var c = document.currentScript,\n        p = c && c.parentNode;\n    if ( p ) {\n        p.removeChild(c);\n    }\n})();",e.appendChild(document.createTextNode(f)),d.appendChild(e),vAPI.injectedScripts=f)}"loading"!==document.readyState?(new vAPI.SafeAnimationFrame(vAPI.domIsLoaded).start(),vAPI.messaging.send("contentscript",{what:"filterSelector"})):document.addEventListener("DOMContentLoaded",vAPI.domIsLoaded)},b=window.location.href;vAPI.messaging.send("contentscript",{what:"retrieveContentScriptParameters",pageURL:b,locationURL:b},a)}(),vAPI.domWatcher=function(){var a=null,b={head:1,link:1,meta:1,script:1,style:1},c=[],d=[],e=!1,f=[],g=function(){h.clear();for(var a,g,i,j=c.length;j--;)for(a=c[j],g=a.length;g--;)i=a[g],1===i.nodeType&&1!==b[i.localName]&&d.push(i);c.length=0,(0!==d.length||e)&&(f[0](d),f[1]&&f[1](d),d.length=0,e=!1)},h=new vAPI.SafeAnimationFrame(g),i=function(a){for(var b,d,f=a.length;f--;)d=a[f],b=d.addedNodes,0!==b.length&&c.push(b),0!==d.removedNodes.length&&(e=!0);(0!==c.length||e)&&h.start()},j=function(b){-1===f.indexOf(b)&&(f.push(b),null===a&&(a=new MutationObserver(i),a.observe(document.documentElement,{childList:!0,subtree:!0})))},k=function(b){var c=f.indexOf(b);-1!==c&&(f.splice(c,1),0===f.length&&null!==a&&(a.disconnect(),a=null))},l=function(){vAPI.shutdown.add(function(){null!==a&&(a.disconnect(),a=null),h.clear()})};return{addListener:j,removeListener:k,start:l}}(),vAPI.domCollapser=function(){var a=null,b=Object.create(null),c=[],d={embed:"src",img:"src",object:"data"},e={img:"srcset"},f=0,g=vAPI.messaging,h=function(a,b,c){this.tag=a,this.attr=b,this.url=c,this.collapse=!1},i=function(a){if(a){var c=a.result;if(null!==c&&Array.isArray(c)!==!1){for(var d,e,h,i,j,k=[],l=a.netSelectorCacheCountMax,m=[null],n=vAPI.iframeLoadEventPatch,o=0,p=c.length;p>o;o++)if(d=c[o],e=d.tag+" "+d.attr+" "+d.url,h=b[e],void 0!==h&&(delete b[e],d.collapse)){Array.isArray(h)===!1&&(m[0]=h,h=m);for(var q=0,r=h.length;r>q;q++)i=h[q],i.style.setProperty("display","none","important"),i.hidden=!0,l>=f&&(j=i.getAttribute(d.attr))&&(k.push(d.tag+"["+d.attr+'="'+j+'"]'),f+=1),n&&n(i)}0!==k.length&&g.send("contentscript",{what:"cosmeticFiltersInjected",type:"net",hostname:window.location.hostname,selectors:k})}}},j=function(){a=null;var b=window.location.hostname||"";b.length&&46===b.charCodeAt(b.length-1)&&(b=b.slice(0,-1)),g.send("contentscript",{what:"filterRequests",pageURL:window.location.href,pageHostname:b,requests:c},i),c=[]},k=function(b){0!==c.length&&(0===b?(clearTimeout(a),j()):null===a&&(a=vAPI.setTimeout(j,b||20)))},l=function(a){var f=a.localName,g=d[f];if(void 0!==g){var i=a[g];if("string"!=typeof i||0===i.length){if(g=e[f],void 0===g)return;if(i=a[g],"string"!=typeof i||0===i.length)return}if(0===i.lastIndexOf("http",0)){var j=f+" "+g+" "+i,k=b[j];void 0===k?(b[j]=a,c.push(new h(f,g,i))):Array.isArray(k)?k.push(a):b[j]=[k,a]}}},m=function(a){for(var b=a.length;b--;)l(a[b])},n=function(a){for(var b=a.length;b--;)r(a[b].target,!0);k()},o=new MutationObserver(n),p={attributes:!0,attributeFilter:["src"]},q=function(a){if(vAPI.injectedScripts){var b=document.createElement("script");b.appendChild(document.createTextNode(vAPI.injectedScripts));var c=a.contentDocument&&a.contentDocument.head;c&&c.appendChild(b)}},r=function(a,d){d!==!0&&o.observe(a,p);var e=a.src;if(""===e||"string"!=typeof e)return void q(a);if(0===e.lastIndexOf("http",0)){var f="iframe src "+e,g=b[f];void 0===g?(b[f]=a,c.push(new h("iframe","src",e))):Array.isArray(g)?g.push(a):b[f]=[g,a]}},s=function(a){for(var b=a.length;b--;)r(a[b])},t=function(a){vAPI.domCollapser.add(a.target),vAPI.domCollapser.process()},u=function(a){for(var b,c=0,d=a.length;d>c;c++)if(b=a[c],"iframe"===b.localName&&r(b),b.children&&0!==b.children.length){var e=b.getElementsByTagName("iframe");0!==e.length&&s(e)}k()},v=function(){for(var b,c=document.images||document.getElementsByTagName("img"),d=c.length;d--;)b=c[d],b.complete&&l(b);m(document.embeds||document.getElementsByTagName("embed")),m(document.getElementsByTagName("object")),s(document.getElementsByTagName("iframe")),k(0),document.addEventListener("error",t,!0),vAPI.domWatcher.addListener(u),vAPI.shutdown.add(function(){document.removeEventListener("error",t,!0),vAPI.domWatcher.removeListener(u),null!==a&&clearTimeout(a)})};return{add:l,addMany:m,addIFrame:r,addIFrames:s,process:k,start:v}}(),vAPI.domSurveyor=function(){var a=null,b=vAPI.messaging,c=[],d=0,e=null,f=[],g=createSet(),h=0,i=function(f){var g=f&&f.result,i=null===e;if(g&&(g.hide.length&&k(g.hide),g.highGenerics&&(e=g.highGenerics)),e){var j=window.performance.now();e.hideLowCount&&l(e.hideLow),e.hideMediumCount&&m(e.hideMedium),(e.hideHighSimpleCount||e.hideHighComplexCount)&&s(),h+=window.performance.now()-j}(i||a.newHideSelectorBuffer.length)&&b.send("contentscript",{what:"cosmeticFiltersInjected",type:"cosmetic",hostname:window.location.hostname,selectors:a.newHideSelectorBuffer,first:i,cost:h}),0===a.newHideSelectorBuffer.length?d+=1:d=0,a.commit(c),c=[]},j=function(a){c=c.concat(a),0!==f.length||null===e?(b.send("contentscript",{what:"retrieveGenericCosmeticSelectors",pageURL:window.location.href,selectors:f,firstSurvey:null===e},i),f=[]):i(null)},k=function(b){a.addSelectors(b)},l=function(b){for(var d,e,f,g,h,i,j=["title","alt"];d=j.pop();)for(f=t("["+d+"]",c),g=f.length;g--;)h=f[g],e=h.getAttribute(d),e&&(i="["+d+'="'+e+'"]',b.hasOwnProperty(i)?a.addSelector(i):(i=h.localName+i,b.hasOwnProperty(i)&&a.addSelector(i)))},m=function(a){var b=c,d=b.length;if(1===d&&b[0]===document.documentElement)return void n(document.links,a);for(var e,f,g=[null];d--;)e=b[d],"a"===e.localName&&(g[0]=e,n(g,a)),f=e.getElementsByTagName("a"),0!==f.length&&n(f,a)},n=function(b,c){for(var d,e,f,g,h,i,j=b.length;j--;)if(d=b[j],e=d.getAttribute("href"),e&&(f=e.indexOf("://"),-1!==f&&(g=c[e.slice(f+3,f+11)],void 0!==g)))if("string"!=typeof g)for(h=g.length;h--;)i=g[h],0===e.lastIndexOf(i.slice(8,-2),0)&&a.addSelector(i);else 0===e.lastIndexOf(g.slice(8,-2),0)&&a.addSelector(g)},o=0,p=!1,q=0,r=!1,s=function(){var b;if(p===!1&&50>o&&0!==e.hideHighSimpleCount){b=window.performance.now();for(var d,f=vAPI.matchesProp,g=c,h=g.length;h--;)if(d=g[h],d[f](e.hideHighSimple)||null!==d.querySelector(e.hideHighSimple)){p=!0,a.addSelectors(e.hideHighSimple.split(",\n"));break}o+=window.performance.now()-b}r===!1&&50>q&&0!==e.hideHighComplexCount&&(b=window.performance.now(),null!==document.querySelector(e.hideHighComplex)&&(r=!0,a.addSelectors(e.hideHighComplex.split(",\n"))),q+=window.performance.now()-b)},t=function(a,b){var c=b,d=c.length;if(1===d&&c[0]===document.documentElement)return document.querySelectorAll(a);for(var e,f,g,h=[];d--;)for(e=c[d],h.push(e),f=e.querySelectorAll(a),g=f.length;g--;)h.push(f[g]);return h},u=function(a){var b,c,d,e,i,k,l=window.performance.now(),m=v,n=g,o=f,p=o.length;for(b=t("[id]",a),c=b.length;c--;)d=b[c],e=d.id,"string"==typeof e&&(e="#"+e.trim(),n.has(e)||1===e.length||(o[p]=e,p++,n.add(e)));for(b=t("[class]",a),c=b.length;c--;)if(d=b[c],i=d.className,"string"==typeof i)if(m.test(i))for(i=d.classList,k=i.length;k--;)e="."+i[k],n.has(e)||(o[p]=e,p++,n.add(e));else e="."+i,n.has(e)||1===e.length||(o[p]=e,p++,n.add(e));h+=window.performance.now()-l,j(a)},v=/\s/,w=function(b){return d>255?(vAPI.domWatcher.removeListener(w),vAPI.domSurveyor=null,a.domChangedHandler(b),void a.start()):void u(b)},x=function(){a=vAPI.domFilterer,w([document.documentElement]),vAPI.domWatcher.addListener(w),vAPI.shutdown.add(function(){vAPI.domWatcher.removeListener(w)})};return{start:x}}(),vAPI.domIsLoaded=function(a){if(null!==window.location){var b=a instanceof Event;b&&document.removeEventListener("DOMContentLoaded",vAPI.domIsLoaded),vAPI||(vAPI=this),vAPI.domIsLoaded=null,vAPI.domWatcher.start(),vAPI.domCollapser.start(),vAPI.domFilterer&&(b&&vAPI.domFilterer.commit("all"),vAPI.domSurveyor?vAPI.domSurveyor.start():vAPI.domFilterer.start());var c=function(a){for(var b=a.target;null!==b&&"a"!==b.localName;)b=b.parentElement;vAPI.messaging.send("contentscript",{what:"mouseClick",x:a.clientX,y:a.clientY,url:null!==b?b.href:""})};!function(){window===window.top&&vAPI.domFilterer&&(document.addEventListener("mousedown",c,!0),vAPI.shutdown.add(function(){document.removeEventListener("mousedown",c,!0)}))}()}};
"use strict";µBlock.Firewall=function(){var a="chmdgxwtetgu",b=function(){this.reset()},c={"3p":!0,image:!0,"inline-script":!0,"1p-script":!0,"3p-script":!0,"3p-frame":!0},d={"*":0,"inline-script":2,"1p-script":4,"3p-script":6,"3p-frame":8,image:10,"3p":12},e={1:"block",2:"allow",3:"noop"},f={block:1,allow:2,noop:3},g=/[g-z_-]/,h=/\.\d+$/,i=/[^0-9a-z_.\[\]:-]/,j=function(a){return g.test(a)?!1:h.test(a)?!0:a.startsWith("[")},k=function(a){var b=a.indexOf(".");return-1!==b?a.slice(b+1):"*"!==a&&""!==a?"*":""},l=function(a){return"*"!==a&&""!==a?"*":""},m=function(a){return j(a)?l:k};b.prototype.reset=function(){this.r=0,this.type="",this.y="",this.z="",this.rules={}},b.prototype.assign=function(a){var b,c=this.rules,d=a.rules;for(b in c)c.hasOwnProperty(b)!==!1&&d.hasOwnProperty(b)===!1&&delete c[b];for(b in d)d.hasOwnProperty(b)!==!1&&(c[b]=d[b])},b.prototype.copyRules=function(a,b,c){var d,e,f=this.rules,g=a.rules;e=g["* *"]||0,0!==e?f["* *"]=e:delete f["* *"],d=b+" *",e=g[d]||0,0!==e?f[d]=e:delete f[d];for(var h in c)c.hasOwnProperty(h)!==!1&&(d="* "+h,e=g[d]||0,0!==e?f[d]=e:delete f[d],d=b+" "+h,e=g[d]||0,0!==e?f[d]=e:delete f[d]);return!0},b.prototype.hasSameRules=function(a,b,c){var d,e=this.rules,f=a.rules;if(d="* *",(e[d]||0)!==(f[d]||0))return!1;if(d=b+" *",(e[d]||0)!==(f[d]||0))return!1;for(var g in c){if(d="* "+g,(e[d]||0)!==(f[d]||0))return!1;if(d=b+" "+g,(e[d]||0)!==(f[d]||0))return!1}return!0},b.prototype.setCell=function(a,b,c,e){var f=d[c],g=a+" "+b,h=this.rules[g];void 0===h&&(h=0);var i=h&~(3<<f)|e<<f;return i===h?!1:(0===i?delete this.rules[g]:this.rules[g]=i,!0)},b.prototype.unsetCell=function(a,b,c){return this.evaluateCellZY(a,b,c),0===this.r?!1:(this.setCell(a,b,c,0),!0)},b.prototype.evaluateCell=function(a,b,c){var e=a+" "+b,f=this.rules[e];return void 0===f?0:f>>d[c]&3},b.prototype.clearRegisters=function(){return this.r=0,this.type=this.y=this.z="",this};var n=function(a,b){if("*"===b||"*"===a||""===a)return!1;var c=o(a)||a;return b.endsWith(c)===!1?!0:b.length!==c.length&&"."!==b.charAt(b.length-c.length-1)},o=µBlock.URI.domainFromHostname;return b.prototype.evaluateCellZ=function(a,b,c,e){this.type=c;for(var f,g=d[c],h=a;;){if(this.z=h,f=this.rules[h+" "+b],void 0!==f&&(f=f>>>g&3,0!==f))return this.r=f,f;if(h=e(h),""===h)break}return this.r=0,0},b.prototype.evaluateCellZY=function(a,b,d){var e=b;if(""===e)return this.r=0,this;for(var f=m(a),g=m(b);"*"!==e;){if(this.y=e,0!==this.evaluateCellZ(a,e,"*",f))return this;e=g(e)}var h=n(a,b);if(this.y="*",h){if("script"===d){if(0!==this.evaluateCellZ(a,"*","3p-script",f))return this}else if("sub_frame"===d&&0!==this.evaluateCellZ(a,"*","3p-frame",f))return this;if(0!==this.evaluateCellZ(a,"*","3p",f))return this}else if("script"===d&&0!==this.evaluateCellZ(a,"*","1p-script",f))return this;return c.hasOwnProperty(d)&&0!==this.evaluateCellZ(a,"*",d,f)?this:0!==this.evaluateCellZ(a,"*","*",f)?this:(this.type="",this)},b.prototype.mustAllowCellZY=function(a,b,c){return 2===this.evaluateCellZY(a,b,c).r},b.prototype.mustBlockOrAllow=function(){return 1===this.r||2===this.r},b.prototype.mustBlock=function(){return 1===this.r},b.prototype.mustAbort=function(){return 3===this.r},b.prototype.toFilterString=function(){if(0===this.r||""===this.type)return"";var a=this.z+" "+this.y+" "+this.type;return 1===this.r?"db:"+a+" block":2===this.r?"da:"+a+" allow":"dn:"+a+" noop"},b.prototype.srcHostnameFromRule=function(a){return a.slice(0,a.indexOf(" "))},b.prototype.desHostnameFromRule=function(a){return a.slice(a.indexOf(" ")+1)},b.prototype.toString=function(){var a,b,c,f,g,h=[];for(a in this.rules)if(this.rules.hasOwnProperty(a)!==!1){f=this.srcHostnameFromRule(a),g=this.desHostnameFromRule(a);for(b in d)d.hasOwnProperty(b)!==!1&&(c=this.evaluateCell(f,g,b),0!==c&&h.push(punycode.toUnicode(f)+" "+punycode.toUnicode(g)+" "+b+" "+e[c]))}return h.join("\n")},b.prototype.fromString=function(a,b){var c,e,g,h,j,k,l,m,n=a.length,o=0;for(b!==!0&&this.reset();n>o;)c=a.indexOf("\n",o),0>c&&(c=a.indexOf("\r",o),0>c&&(c=n)),e=a.slice(o,c).trim(),o=c+1,g=e.indexOf("# "),-1!==g&&(e=e.slice(0,g).trim()),""!==e&&-1===e.indexOf("://")&&(h=e.split(/\s+/),4===h.length&&(h[0].endsWith(":")||(j=punycode.toASCII(h[0]),k=punycode.toASCII(h[1]),"*"!==j&&i.test(j)||"*"!==k&&i.test(k)||(l=h[2],d.hasOwnProperty(l)!==!1&&("*"===k||"*"===l)&&(m=f[h[3]],"number"!=typeof m||0>m||m>3||this.setCell(j,k,l,m))))))},b.prototype.toSelfie=function(){return{magicId:a,rules:this.rules}},b.prototype.fromSelfie=function(a){this.rules=a.rules},b}(),µBlock.sessionFirewall=new µBlock.Firewall,µBlock.permanentFirewall=new µBlock.Firewall;
"use strict";!function(){var a=self.vAPI=self.vAPI||{},b=self.chrome,c=b.runtime.getManifest();a.chrome=!0,a.cantWebsocket=!0;var d=function(){};a.app={name:c.name,version:c.version},a.app.restart=function(){b.runtime.reload()},a.storage=b.storage.local,a.cacheStorage=b.storage.local,a.browserSettings=function(){return b.privacy instanceof Object!=!1?{webRTCSupported:void 0,noopCallback:function(){void b.runtime.lastError},setWebrtcIPAddress:function(a){if(void 0===this.webRTCSupported){this.webRTCSupported={setting:a};var c=document.createElement("iframe"),d=this,e=function(a){if(a.origin===self.location.origin){window.removeEventListener("message",e);var b=d.webRTCSupported.setting;d.webRTCSupported="webRTCSupported"===a.data,d.setWebrtcIPAddress(b),c.parentNode.removeChild(c),c=null}};return window.addEventListener("message",e),c.src="is-webrtc-supported.html",void document.body.appendChild(c)}if("object"==typeof this.webRTCSupported)return void(this.webRTCSupported.setting=a);if(this.webRTCSupported===!0){var f=b.privacy,g=f.network;if("object"==typeof g.webRTCMultipleRoutesEnabled)try{a?g.webRTCMultipleRoutesEnabled.clear({scope:"regular"},this.noopCallback):g.webRTCMultipleRoutesEnabled.set({value:!1,scope:"regular"},this.noopCallback)}catch(h){console.error(h)}if("object"==typeof g.webRTCIPHandlingPolicy)try{a?g.webRTCIPHandlingPolicy.clear({scope:"regular"},this.noopCallback):g.webRTCIPHandlingPolicy.set({value:"disable_non_proxied_udp",scope:"regular"},this.noopCallback)}catch(h){console.error(h)}}},set:function(a){for(var c in a)if(a.hasOwnProperty(c)!==!1)switch(c){case"prefetching":try{a[c]?b.privacy.network.networkPredictionEnabled.clear({scope:"regular"},this.noopCallback):b.privacy.network.networkPredictionEnabled.set({value:!1,scope:"regular"},this.noopCallback)}catch(d){console.error(d)}break;case"hyperlinkAuditing":try{a[c]?b.privacy.websites.hyperlinkAuditingEnabled.clear({scope:"regular"},this.noopCallback):b.privacy.websites.hyperlinkAuditingEnabled.set({value:!1,scope:"regular"},this.noopCallback)}catch(d){console.error(d)}break;case"webrtcIPAddress":this.setWebrtcIPAddress(!!a[c])}}}:void 0}(),a.tabs={},a.isBehindTheSceneTabId=function(a){return"-1"===a.toString()},a.noTabId="-1";var e=function(a){return"string"==typeof a&&(a=parseInt(a,10)),"number"!=typeof a||isNaN(a)||-1===a?0:a};a.tabs.registerListeners=function(){var c=this.onNavigation||d,e=this.onUpdated||d,f=/^https?:\/\//,g=function(a){if(a.startsWith("data:")===!1)return a;var b=a.indexOf(",");if(-1===b)return a;var c=a.slice(0,b);return-1===c.search(/\s/)?a:c.replace(/\s+/,"")+a.slice(b)},h=function(b){f.test(b.url)===!1&&(b.frameId=0,b.url=g(b.url),c(b)),"function"==typeof a.tabs.onPopupCreated&&a.tabs.onPopupCreated(b.tabId.toString(),b.sourceTabId.toString())},i=function(a){0!==a.frameId},j=function(a){0===a.frameId&&(a.url=g(a.url),c(a))},k=function(b){a.contextMenu.onMustUpdate(b.tabId)},l=function(a,b,c){b.url&&(b.url=g(b.url)),e(a.toString(),b,c)};b.webNavigation.onBeforeNavigate.addListener(i),b.webNavigation.onCommitted.addListener(j),b.webNavigation.onCreatedNavigationTarget instanceof Object&&b.webNavigation.onCreatedNavigationTarget.addListener(h),b.tabs.onActivated.addListener(k),b.tabs.onUpdated.addListener(l),"function"==typeof this.onClosed&&b.tabs.onRemoved.addListener(this.onClosed)},a.tabs.get=function(a,c){var d=function(a){b.runtime.lastError,c(a)};if(null!==a)return a=e(a),void(0===a?d(null):b.tabs.get(a,d));var f=function(a){void b.runtime.lastError,c(a[0])};b.tabs.query({active:!0,currentWindow:!0},f)},a.tabs.open=function(c){var d=c.url;if("string"!=typeof d||""===d)return null;/^[\w-]{2,}:/.test(d)!==!0&&(d=a.getURL(d));var f=function(){void 0===c.active&&(c.active=!0);var f=function(){var f={url:d,active:!!c.active},g=function(a){a.active&&b.windows.update(a.windowId,{focused:!0})};return c.tabId?void b.tabs.update(e(c.tabId),f,function(d){a.lastError()?b.tabs.create(f,g):void 0!==c.index&&b.tabs.move(d.id,{index:c.index})}):(void 0!==c.index&&(f.index=c.index),void b.tabs.create(f,g))};return c.popup===!0?void b.windows.create({url:c.url,type:"popup"}):-1!==c.index?void f():void a.tabs.get(null,function(a){a?c.index=a.index+1:delete c.index,f()})};if(!c.select)return void f();var g=d.indexOf("#"),h=-1===g?d:d.slice(0,g);b.tabs.query({url:h},function(a){var c=a[0];if(!c)return void f();var e={active:!0,url:void 0};d!==c.url&&(e.url=d),b.tabs.update(c.id,e,function(a){b.windows.update(a.windowId,{focused:!0})})})},a.tabs.replace=function(c,d){if(c=e(c),0!==c){var f=d;/^[\w-]{2,}:/.test(f)!==!0&&(f=a.getURL(f)),b.tabs.update(c,{url:f},function(){b.runtime.lastError})}},a.tabs.remove=function(a){if(a=e(a),0!==a){var c=function(){b.runtime.lastError};b.tabs.remove(a,c)}},a.tabs.reload=function(a){if(a=e(a),0!==a){var c=function(){b.runtime.lastError};b.tabs.reload(a,c)}},a.tabs.select=function(a){a=e(a),0!==a&&b.tabs.update(a,{active:!0},function(a){b.runtime.lastError,a&&b.windows.update(a.windowId,{focused:!0})})},a.tabs.injectScript=function(a,c,d){var f=function(){b.runtime.lastError,"function"==typeof d&&d()};a?b.tabs.executeScript(e(a),c,f):b.tabs.executeScript(c,f)},a.setIcon=function(c,d,f){if(c=e(c),0!==c){var g=function(){a.lastError()||(b.browserAction.setBadgeText({tabId:c,text:f}),""!==f&&b.browserAction.setBadgeBackgroundColor({tabId:c,color:"#666"}))},h="on"===d?{19:"img/browsericons/icon19.png",38:"img/browsericons/icon38.png"}:{19:"img/browsericons/icon19-off.png",38:"img/browsericons/icon38-off.png"};b.browserAction.setIcon({tabId:c,path:h},g),a.contextMenu.onMustUpdate(c)}},a.messaging={ports:{},listeners:{},defaultHandler:null,NOOPFUNC:d,UNHANDLED:"vAPI.messaging.notHandled"},a.messaging.listen=function(a,b){this.listeners[a]=b},a.messaging.onPortMessage=function(){var b=a.messaging,c={},d=function(a,b,c){this.callback=this.proxy.bind(this),this.init(a,b,c)};d.prototype.init=function(b,c,d){return this.port=b,this.request=c,this.timerId=void 0!==d?a.setTimeout(this.callback,d):null,this},d.prototype.proxy=function(a){null!==this.timerId&&(clearTimeout(this.timerId),delete c[this.timerId],this.timerId=null),b.ports.hasOwnProperty(this.port.name)&&this.port.postMessage({auxProcessId:this.request.auxProcessId,channelName:this.request.channelName,msg:void 0!==a?a:null}),this.port=this.request=null,f.push(this)};var f=[],g=function(a,b,c){var e=f.pop();return e?e.init(a,b,c):new d(a,b,c)},h=function(a,d){var f,h,i=e(a.toTabId);for(var j in b.ports)if(b.ports.hasOwnProperty(j)!==!1&&(f=b.ports[j],0===f.sender.frameId&&f.sender.tab.id===i)){h=f;break}var k;return void 0!==a.auxProcessId&&(k=g(d,a,1023)),void 0===h?void(void 0!==k&&k.callback()):(void 0!==k&&(c[k.timerId]=k),void h.postMessage({mainProcessId:k&&k.timerId,channelName:a.toChannel,msg:a.msg}))},i=function(a){var b=a.mainProcessId;if(void 0!==b&&c.hasOwnProperty(b)!==!1){var d=c[b];delete c[b],d.callback(a.msg)}};return function(a,c){if(void 0!==a.toTabId)return void h(a,c);if(void 0!==a.mainProcessId)return void i(a);var d=b.NOOPFUNC;void 0!==a.auxProcessId&&(d=g(c,a).callback);var e=b.UNHANDLED,f=b.listeners[a.channelName];"function"==typeof f&&(e=f(a.msg,c.sender,d)),e===b.UNHANDLED&&(e=b.defaultHandler(a.msg,c.sender,d),e===b.UNHANDLED&&(console.error("uBlock> messaging > unknown request: %o",a),d()))}}(),a.messaging.onPortDisconnect=function(b){b.onDisconnect.removeListener(a.messaging.onPortDisconnect),b.onMessage.removeListener(a.messaging.onPortMessage),delete a.messaging.ports[b.name]},a.messaging.onPortConnect=function(b){b.onDisconnect.addListener(a.messaging.onPortDisconnect),b.onMessage.addListener(a.messaging.onPortMessage),a.messaging.ports[b.name]=b},a.messaging.setup=function(c){null===this.defaultHandler&&("function"!=typeof c&&(c=function(){return a.messaging.UNHANDLED}),this.defaultHandler=c,b.runtime.onConnect.addListener(this.onPortConnect))},a.messaging.broadcast=function(a){var b={broadcast:!0,msg:a};for(var c in this.ports)this.ports.hasOwnProperty(c)!==!1&&this.ports[c].postMessage(b)},a.net={},a.net.onBeforeSendHeader=function(a){b.webRequest.onBeforeSendHeaders.addListener(a.callback,{urls:a.urls,types:a.types},a.extra)},a.net.registerListeners=function(){var a=µBlock,c=a.URI,d=b.webRequest,e=/\bChrom[a-z]+\/(?:3[89]|4[0-8])\.[\d.]+\b/.test(navigator.userAgent),f={main_frame:!0,sub_frame:!0,stylesheet:!0,script:!0,image:!0,object:!0,xmlhttprequest:!0,other:!0};d.ResourceType&&!function(){for(var a in d.ResourceType)d.ResourceType.hasOwnProperty(a)&&(f[d.ResourceType[a]]=!0)}();var g,h,i=new Map([["eot","font"],["otf","font"],["svg","font"],["ttf","font"],["woff","font"],["woff2","font"],["mp3","media"],["mp4","media"],["webm","media"],["gif","image"],["ico","image"],["jpeg","image"],["jpg","image"],["png","image"],["webp","image"]]),j=function(a){if(0===a.length)return Object.keys(f);for(var b,c=[],d=a.length,e=!0;d--;)b=a[d],f[b]&&c.push(b),"other"===b&&(e=!1);return e&&c.push("other"),c},k=function(a,b){for(var c=a.length;c--;)if(a[c].name.toLowerCase()===b)return a[c].value.trim();return""},l=function(a){a.tabId=a.tabId.toString();var b=a.type;if("ping"===b)return void(a.type="beacon");if("imageset"===b)return void(a.type="image");if("other"===b){var d=c.pathFromURI(a.url),f=d.indexOf(".",d.length-6);if(-1!==f&&(b=i.get(d.slice(f+1))))return void(a.type=b);if(a.responseHeaders){if(b=k(a.responseHeaders,"content-type"),b.startsWith("font/"))return void(a.type="font");if(b.startsWith("image/"))return void(a.type="image");if(b.startsWith("audio/")||b.startsWith("video/"))return void(a.type="media")}e&&(a.type="object")}},m=function(a){if("image"===a.type||"HEAD"===a.method&&"xmlhttprequest"===a.type){var b=a.url,c=/[?&]u(?:rl)?=([^&]+)/.exec(b);if(null!==c){a.type="websocket",a.url=decodeURIComponent(c[1]);var d=n(a);return d&&d.cancel?d:(c=/[?&]r=([^&]+)/.exec(b),{redirectUrl:null!==c?decodeURIComponent(c[1]):"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="})}}},n=this.onBeforeRequest.callback,o=f.websocket?function(a){return l(a),n(a)}:function(a){if(a.url.endsWith("ubofix=f41665f3028c7fd10eecf573336216d3")){var b=m(a);if(void 0!==b)return b}return l(a),n(a)},p=f.csp_report?null:function(a){if("ping"===a.type&&"POST"===a.method){var b=k(a.requestHeaders,"content-type");if(""!==b)return b.endsWith("/csp-report")?(a.type="csp_report",n(a)):void 0}},q=this.onHeadersReceived.callback,r=this.onHeadersReceived.types.slice(0),s=j(r),t=f.font?function(a){return l(a),0===r.length||-1!==r.indexOf(a.type)?q(a):void 0}:function(a){if(l(a),"font"===a.type){var b=n(a);if("object"==typeof b&&b.cancel===!0)return{cancel:!0}}return 0===r.length||-1!==r.indexOf(a.type)?q(a):void 0};o&&(g=this.onBeforeRequest.urls||["<all_urls>"],h=this.onBeforeRequest.types||void 0,!f.websocket||void 0!==h&&-1===h.indexOf("websocket")||-1!==g.indexOf("<all_urls>")||(-1===g.indexOf("ws://*/*")&&g.push("ws://*/*"),-1===g.indexOf("wss://*/*")&&g.push("wss://*/*")),d.onBeforeRequest.addListener(o,{urls:g,types:h},this.onBeforeRequest.extra)),p&&d.onBeforeSendHeaders.addListener(p,{urls:["<all_urls>"],types:["ping"]},["blocking","requestHeaders"]),t&&(g=this.onHeadersReceived.urls||["<all_urls>"],h=s,d.onHeadersReceived.addListener(t,{urls:g,types:h},this.onHeadersReceived.extra))},a.contextMenu={_callback:null,_entries:[],_createEntry:function(a){b.contextMenus.create(JSON.parse(JSON.stringify(a)),function(){void b.runtime.lastError})},onMustUpdate:function(){},setEntries:function(a,c){a=a||[];for(var d,e,f=Math.max(this._entries.length,a.length),g=0;f>g;g++)d=this._entries[g],e=a[g],d&&e?e.id!==d&&(b.contextMenus.remove(d),this._createEntry(e),this._entries[g]=e.id):d&&!e?b.contextMenus.remove(d):!d&&e&&(this._createEntry(e),this._entries[g]=e.id);f=this._entries.length=a.length,c=c||null,c!==this._callback&&(0!==f&&null!==c?(b.contextMenus.onClicked.addListener(c),this._callback=c):0===f&&null!==this._callback&&(b.contextMenus.onClicked.removeListener(this._callback),this._callback=null))}},a.lastError=function(){return b.runtime.lastError},a.onLoadAllCompleted=function(){var c=function(){a.lastError()},d=function(b){a.tabs.injectScript(b,{file:"js/vapi-client.js",allFrames:!0,runAt:"document_idle"},function(){}),a.tabs.injectScript(b,{file:"js/contentscript.js",allFrames:!0,runAt:"document_idle"},c)},e=function(a){for(var b,c=µBlock,e=a.length;e--;)b=a[e],c.tabContextManager.commit(b.id,b.url),c.bindTabToPageStats(b.id),/^https?:\/\//.test(b.url)&&d(b.id)};b.tabs.query({url:"<all_urls>"},e)},a.punycodeHostname=function(a){return a},a.punycodeURL=function(a){return a},a.adminStorage={getItem:function(a,c){var d=function(d){var e;b.runtime.lastError||"object"!=typeof d||null===d||(e=d[a]),c(e)};try{b.storage.managed.get(a,d)}catch(e){c()}}},a.cloud=function(){if(b.storage.sync instanceof Object!=!1){var a=16,c=Math.floor(384)&~(a-1),d=Math.floor(.75*b.storage.sync.QUOTA_BYTES_PER_ITEM||6144),e=b.storage.sync.QUOTA_BYTES||102400,f={defaultDeviceName:window.navigator.platform,deviceName:window.localStorage.getItem("deviceName")||""},g=function(a,d){for(var e={},f=0;c>f;f+=16)e[a+f.toString()]="";b.storage.sync.get(e,function(e){if(b.runtime.lastError)return void d(0,b.runtime.lastError.message);for(var f=0,g=0;c>g&&""!==e[a+g.toString()];g+=16)f=g+16;d(f)})},h=function(a,f){for(var g=[],h=Math.min(c,Math.ceil(e/d)),i=f;h>i;i++)g.push(a+i.toString());b.storage.sync.remove(g)},i=function(){},j=function(a,c,e){var g={source:f.deviceName||f.defaultDeviceName,tstamp:Date.now(),data:c,size:0};g.size=JSON.stringify(g).length;var i=JSON.stringify(g);g={};for(var j=Math.ceil(i.length/d),k=0;j>k;k++)g[a+k.toString()]=i.substr(k*d,d);g[a+k.toString()]="",b.storage.sync.set(g,function(){var c;b.runtime.lastError&&(c=b.runtime.lastError.message),e(c),h(a,j)})},k=function(a,c){var d=function(d){if(b.runtime.lastError)return void c(null,b.runtime.lastError.message);for(var e,f=[],g=0;e=d[a+g.toString()],""!==e;)f.push(e),g+=1;var h=null;try{h=JSON.parse(f.join(""))}catch(i){}c(h)},e=function(e,f){if(0===e||"string"==typeof f)return void c(null,f);for(var g={},h=0;e>h;h++)g[a+h.toString()]="";b.storage.sync.get(g,d)};g(a,e)},l=function(a){"function"==typeof a&&a(f)},m=function(a,b){"object"==typeof a&&null!==a&&("string"==typeof a.deviceName&&(window.localStorage.setItem("deviceName",a.deviceName),f.deviceName=a.deviceName),l(b))};return{start:i,push:j,pull:k,getOptions:l,setOptions:m}}}()}();
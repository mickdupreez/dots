"use strict";!function(a){if(document instanceof HTMLDocument!=!1||document instanceof XMLDocument!=!1&&document.createElement("div")instanceof HTMLDivElement!=!1){var b=document.contentType||"";if(!/^image\/|^text\/plain/.test(b)){a.vAPI&&a.vAPI.uBO===!0||(a.vAPI={uBO:!0});var c=a.vAPI,d=a.chrome;if(!c.sessionId){a.Set instanceof Function?a.createSet=function(){return new Set}:a.createSet=function(){var a=function(){this.clear()};a.prototype={add:function(a){return void 0===this._set[a]&&(this._set[a]=!0,this.size+=1),this},clear:function(){this._set=Object.create(null),this.size=0,this._values=void 0,this._i=void 0,this.value=void 0,this.done=!0},"delete":function(a){return void 0===this._set[a]?!1:(delete this._set[a],this.size-=1,!0)},has:function(a){return void 0!==this._set[a]},next:function(){return this._i<this.size?this.value=this._values[this._i++]:(this._values=void 0,this.value=void 0,this.done=!0),this},polyfill:!0,values:function(){return this._values=Object.keys(this._set),this._i=0,this.value=void 0,this.done=!1,this}};var b=function(){this.clear()};return b.prototype={add:function(a){-1===this._set.indexOf(a)&&this._set.push(a)},clear:function(){this._set=[],this._i=0,this.value=void 0,this.done=!0},"delete":function(a){var b=this._set.indexOf(a);return-1===b?!1:(this._set.splice(b,1),!0)},has:function(a){return-1!==this._set.indexOf(a)},next:function(){return this._i===this._set.length?(this.value=void 0,this.done=!0):(this.value=this._set[this._i],this._i+=1),this},polyfill:!0,values:function(){return this._i=0,this.done=!1,this}},Object.defineProperty(b.prototype,"size",{get:function(){return this._set.length}}),function(c){return"object"===c?new b:new a}}();var e=0;c.lock=function(){e+=1},c.unlock=function(){e-=1},c.executionCost={start:function(){},stop:function(){}},c.executionCost.start(),c.randomToken=function(){return String.fromCharCode(Date.now()%26+97)+Math.floor(982451653*Math.random()+982451653).toString(36)},c.sessionId=c.randomToken(),c.chrome=!0,c.setTimeout=c.setTimeout||a.setTimeout.bind(a),c.shutdown={jobs:[],add:function(a){this.jobs.push(a)},exec:function(){for(var a;a=this.jobs.pop();)a()},remove:function(a){for(var b;-1!==(b=this.jobs.indexOf(a));)this.jobs.splice(b,1)}},c.messaging={port:null,portTimer:null,portTimerDelay:1e4,channels:Object.create(null),channelCount:0,pending:Object.create(null),pendingCount:0,auxProcessId:1,shuttingDown:!1,shutdown:function(){this.shuttingDown=!0,this.destroyPort()},disconnectListener:function(){this.port=null,c.shutdown.exec()},disconnectListenerCallback:null,messageListener:function(a){if(a)if(a.broadcast!==!0||a.channelName){if(a.auxProcessId){var b=this.pending[a.auxProcessId];if(delete this.pending[a.auxProcessId],delete a.auxProcessId,b)return this.pendingCount-=1,void b(a.msg)}var c=this.sendToChannelListeners(a.channelName,a.msg);if(void 0!==a.mainProcessId){var d=this.connect();null!==d&&d.postMessage({mainProcessId:a.mainProcessId,msg:c})}}else for(var e in this.channels)this.sendToChannelListeners(e,a.msg)},messageListenerCallback:null,portPoller:function(){return this.portTimer=null,null===this.port||0===this.channelCount&&0===this.pendingCount?void this.destroyPort():(this.portTimer=c.setTimeout(this.portPollerCallback,this.portTimerDelay),void(this.portTimerDelay=Math.min(2*this.portTimerDelay,36e5)))},portPollerCallback:null,destroyPort:function(){null!==this.portTimer&&(clearTimeout(this.portTimer),this.portTimer=null);var a=this.port;if(null!==a&&(a.disconnect(),a.onMessage.removeListener(this.messageListenerCallback),a.onDisconnect.removeListener(this.disconnectListenerCallback),this.port=null),0!==this.channelCount&&(this.channels=Object.create(null),this.channelCount=0),0!==this.pendingCount){var b,c=this.pending;this.pending=Object.create(null),this.pendingCount=0;for(var d in c)b=c[d],"function"==typeof b&&b(null)}},createPort:function(){if(this.shuttingDown)return null;null===this.messageListenerCallback&&(this.messageListenerCallback=this.messageListener.bind(this),this.disconnectListenerCallback=this.disconnectListener.bind(this),this.portPollerCallback=this.portPoller.bind(this));try{this.port=d.runtime.connect({name:c.sessionId})||null}catch(a){this.port=null}return null!==this.port&&(this.port.onMessage.addListener(this.messageListenerCallback),this.port.onDisconnect.addListener(this.disconnectListenerCallback)),this.portTimerDelay=1e4,null===this.portTimer&&(this.portTimer=c.setTimeout(this.portPollerCallback,this.portTimerDelay)),this.port},connect:function(){return null!==this.port?this.port:this.createPort()},send:function(a,b,c){this.sendTo(a,b,void 0,void 0,c)},sendTo:function(a,b,d,e,f){this.pendingCount>25&&c.shutdown.exec();var g=this.connect();if(null===g)return void("function"==typeof f&&f());var h;f&&(h=this.auxProcessId++,this.pending[h]=f,this.pendingCount+=1),g.postMessage({channelName:a,auxProcessId:h,toTabId:d,toChannel:e,msg:b})},addChannelListener:function(a,b){if("function"==typeof b){var c=this.channels[a];if(void 0!==c&&-1!==c.indexOf(b))return void console.error('Duplicate listener on channel "%s"',a);void 0===c?(this.channels[a]=[b],this.channelCount+=1):c.push(b),this.connect()}},removeChannelListener:function(a,b){if("function"==typeof b){var c=this.channels[a];if(void 0!==c){var d=c.indexOf(b);if(-1===d)return void console.error('Listener not found on channel "%s"',a);c.splice(d,1),0===c.length&&(delete this.channels[a],this.channelCount-=1)}}},removeAllChannelListeners:function(a){var b=this.channels[a];void 0!==b&&(delete this.channels[a],this.channelCount-=1)},sendToChannelListeners:function(a,b){var c=this.channels[a];if(void 0!==c){for(var d,e=0,f=c.length;f>e&&(d=c[e](b),void 0===d);e++);return d}}},c.shutdown.add(function(){c.messaging.shutdown(),delete window.vAPI}),c.executionCost.stop("vapi-client.js")}}}}(this);